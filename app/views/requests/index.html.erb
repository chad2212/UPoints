<p id="notice"><%= notice %></p>
<br>
<h1 style="text-align:center">Requests</h1>
<br>
<style>
  table, th {
    border-bottom: 2px solid;
    padding: 10px;
    white-space: nowrap;
    table-layout: fixed;
    text-overflow: ellipsis;
    max-width: 200px;
  }
  td {
    border-bottom: 1px solid;
    padding: 10px;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    max-width: 200px;
  }
</style>
<div class="tab">
  <button class="tablinks" onclick="openTab(event, 'Requests')" id="defaultOpen">All Requests</button>
  <button class="tablinks" onclick="openTab(event, 'Posts')">Your Requests</button>
  <button class="tablinks" onclick="openTab(event, 'Accepted')">Accepted Requests</button>
</div>

<div id="Requests" class="tabcontent">
  <table>
    <thead>
    <tr>
      <th>Rating</th>
      <th>Poster</th>
      <th>Food Description</th>
      <th>Price</th>
      <th>Start Time</th>
      <th>End Time</th>
      <th>Location</th>
      <th>Exchange Method</th>
      <th>Special Request</th>
      <th colspan="3" style="text-align:center">View</th>
    </tr>
    </thead>

    <tbody>
    <% @requests.each do |request| %>
        <tr id="highlight">
          <td><%= request.buyer_rating %></td>
          <td><%= request.buyer %></td>
          <td style="width:50px;text-overflow:ellipsis"><%= request.food_description %></td>
          <td><%= request.price %></td>
          <td><%= request.start_time %></td>
          <td><%= request.end_time %></td>
          <td><%= request.location %></td>
          <td><%= request.exchange_method %></td>
          <td><%= request.special_request %></td>
          <td><%= link_to 'Accept', request %></td>
          <td><%= link_to 'Expand', request %></td>
          <!--<td><%= link_to 'Edit', edit_request_path(request) %></td>-->
          <!--<td><%= link_to 'Delete', request, method: :delete, data: { confirm: 'Are you sure?' } %></td>-->
        </tr>
    <% end %>
    </tbody>
  </table>

  <br>

  <%= link_to 'New Request', new_request_path %>
</div>

<div id="Posts" class="tabcontent">
    <table>
      <thead>
      <tr>
        <th>Food Description</th>
        <th>Price</th>
        <th>Start Time</th>
        <th>End Time</th>
        <th>Location</th>
        <th>Exchange Method</th>
        <th>Special Request</th>
        <th colspan="3" style="text-align:center">View</th>
      </tr>
      </thead>

      <tbody>
      <% @user_posted_requests.each do |request| %>
          <tr id="highlight">
            <td style="width:50px;text-overflow:ellipsis"><%= request.food_description %></td>
            <td><%= request.price %></td>
            <td><%= request.start_time %></td>
            <td><%= request.end_time %></td>
            <td><%= request.location %></td>
            <td><%= request.exchange_method %></td>
            <td><%= request.special_request %></td>
            <%= link_to 'Edit', edit_request_path(request) %></td>
            <%= link_to 'Delete', request, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
          <br>

          <%= link_to 'New Request', new_request_path %>
      <% end %>
      </tbody>
    </table>
  <br>

  <%= link_to 'New Request', new_request_path %>

</div>

<div id="Accepted" class="tabcontent">
  <table>
    <thead>
    <tr>
      <th>Rating</th>
      <th>Poster</th>
      <th>Price</th>
      <th>Food Description</th>
      <th>Start Time</th>
      <th>End Time</th>
      <th>Location</th>
      <th>Exchange Method</th>
      <th>Special Request</th>
      <th colspan="3" style="text-align:center">View</th>
    </tr>
    </thead>

    <tbody>
    <% @user_accepted_requests.each do |request| %>
        <tr id="highlight">
          <td><%= request.buyer_rating %></td>
          <td><%= request.buyer %></td>
          <td><%= request.price %></td>
          <td style="width:50px;text-overflow:ellipsis"><%= request.food_description %></td>
          <td><%= request.start_time %></td>
          <td><%= request.end_time %></td>
          <td><%= request.location %></td>
          <td><%= request.exchange_method %></td>
          <td><%= request.special_request %></td>
          <%= link_to 'Edit', edit_request_path(request) %></td>
          <%= link_to 'Delete', request, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        </tr>
    <% end %>
    </tbody>
  </table>
</div>

<script>
    function openTab(evt, cityName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(cityName).style.display = "block";
        evt.currentTarget.className += " active";
    }

    // Get the element with id="defaultOpen" and click on it
    document.getElementById("defaultOpen").click();
</script>

